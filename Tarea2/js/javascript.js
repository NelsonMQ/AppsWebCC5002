var RegionesYcomunas = {regiones : [
  {
    region: "Región Metropolitana de Santiago",
    comunas: [
      "Cerrillos",
      "Cerro Navia",
      "Conchalí",
      "El Bosque",
      "Estación Central",
      "Huechuraba",
      "Independencia",
      "La Cisterna",
      "La Florida",
      "La Granja",
      "La Pintana",
      "La Reina",
      "Las Condes",
      "Lo Barnechea",
      "Lo Espejo",
      "Lo Prado",
      "Macul",
      "Maipú",
      "Ñuñoa",
      "Pedro Aguirre Cerda",
      "Peñalolén",
      "Providencia",
      "Pudahuel",
      "Quilicura",
      "Quinta Normal",
      "Recoleta",
      "Renca",
      "Santiago",
      "San Joaquín",
      "San Miguel",
      "San Ramón",
      "Vitacura",
      "Puente Alto",
      "Pirque",
      "San José de Maipo",
      "Colina",
      "Lampa",
      "Tiltil",
      "San Bernardo",
      "Buin",
      "Calera de Tango",
      "Paine",
      "Melipilla",
      "Alhué",
      "Curacaví",
      "María Pinto",
      "San Pedro",
      "Talagante",
      "El Monte",
      "Isla de Maipo",
      "Padre Hurtado",
      "Peñaflor"
    ]
  },
  {
    region: "Región de Tarapacá",
    comunas: [
      "Iquique",
      "Alto Hospicio",
      "Pozo Almonte",
      "Camiña",
      "Colchane",
      "Huara",
      "Pica"
    ]
  },
  {
    region: "Región de Antofagasta",
    comunas: [
      "Antofagasta",
      "Mejillones",
      "Sierra Gorda",
      "Taltal",
      "Calama",
      "Ollague",
      "San Pedro Atacama",
      "Tocopilla",
      "María Elena"
    ]
  },
  {
    region: "Región de Atacama",
    comunas: [
      "Copiapó",
      "Caldera",
      "Tierra Amarilla",
      "Chañaral",
      "Diego de Almagro",
      "Vallenar",
      "Alto del Carmen",
      "Freirina",
      "Huasco"
    ]
  },
  {
    region: "Región de Coquimbo",
    comunas: [
      "La Serena",
      "Coquimbo",
      "Andacollo",
      "La Higuera",
      "Paihuano",
      "Vicuña",
      "Illapel",
      "Los Vilos",
      "Salamanca",
      "Ovalle",
      "Combarbalá",
      "Monte Patria",
      "Punitaqui",
      "Río Hurtado"
    ]
  },
  {
    region: "Región de Valparaíso",
    comunas: [
      "Valparaíso",
      "Casablanca",
      "Concón",
      "Juan Fernández",
      "Puchuncaví",
      "Quintero",
      "Viña del Mar",
      "Isla de Pascua",
      "Los Andes",
      "Calle Larga",
      "Rinconada",
      "San Esteban",
      "La Ligua",
      "Cabildo",
      "Papudo",
      "Petorca",
      "Zapallar",
      "Quillota",
      "La Calera",
      "Hijuelas",
      "La Cruz",
      "Nogales",
      "San Antonio",
      "Algarrobo",
      "Cartagena",
      "El Quisco",
      "El Tabo",
      "Santo Domingo",
      "San Felipe",
      "Catemu",
      "Llay Llay",
      "Putaendo",
      "Santa María",
      "Quilpué",
      "Limache",
      "Olmué",
      "Villa Alemana"
    ]
  },
  {
    region: "Región del Libertador Bernardo Ohiggins",
    comunas: [
      "Rancagua",
      "Codegua",
      "Coinco",
      "Coltauco",
      "Doñihue",
      "Graneros",
      "Las Cabras",
      "Machalí",
      "Malloa",
      "Olivar",
      "Peumo",
      "Pichidegua",
      "Quinta Tilcoco",
      "Rengo",
      "Requínoa",
      "San Vicente",
      "Pichilemu",
      "La Estrella",
      "Litueche",
      "Marchigue",
      "Navidad",
      "Paredones",
      "San Fernando",
      "Chépica",
      "Chimbarongo",
      "Lolol",
      "Nancagua",
      "Palmilla",
      "Peralillo",
      "Placilla",
      "Pumanque",
      "Santa Cruz"
    ]
  },
  {
    region: "Región del Maule",
    comunas: [
      "Talca",
      "Constitución",
      "Curepto",
      "Empedrado",
      "Maule",
      "Pelarco",
      "Pencahue",
      "Río Claro",
      "San Clemente",
      "San Rafael",
      "Cauquenes",
      "Chanco",
      "Pelluhue",
      "Curicó",
      "Hualañé",
      "Licantén",
      "Molina",
      "Rauco",
      "Romeral",
      "Sagrada Familia",
      "Teno",
      "Vichuquén",
      "Linares",
      "Colbún",
      "Longaví",
      "Parral",
      "Retiro",
      "San Javier",
      "Villa Alegre",
      "Yerbas Buenas"
    ]
  },
  {
    region: "Región del Biobío",
    comunas: [
      "Concepción",
      "Coronel",
      "Chiguayante",
      "Florida",
      "Hualqui",
      "Lota",
      "Penco",
      "San Pedro de la Paz",
      "Santa Juana",
      "Talcahuano",
      "Tomé",
      "Hualpén",
      "Lebu",
      "Arauco",
      "Cañete",
      "Contulmo",
      "Curanilahue",
      "Los Álamos",
      "Tirúa",
      "Los Ángeles",
      "Antuco",
      "Cabrero",
      "Laja",
      "Mulchén",
      "Nacimiento",
      "Negrete",
      "Quilaco",
      "Quilleco",
      "San Rosendo",
      "Santa Bárbara",
      "Tucapel",
      "Yumbel",
      "Alto Bio Bío"
    ]
  },
  {
    region: "Región de la Araucanía",
    comunas: [
      "Temuco",
      "Carahue",
      "Cunco",
      "Curarrehue",
      "Freire",
      "Galvarino",
      "Gorbea",
      "Lautaro",
      "Loncoche",
      "Melipeuco",
      "Nueva Imperial",
      "Padre Las Casas",
      "Perquenco",
      "Pitrufquén",
      "Pucón",
      "Puerto Saavedra",
      "Teodoro Schmidt",
      "Toltén",
      "Vilcún",
      "Villarrica",
      "Cholchol",
      "Angol",
      "Collipulli",
      "Curacautín",
      "Ercilla",
      "Lonquimay",
      "Los Sauces",
      "Lumaco",
      "Purén",
      "Renaico",
      "Traiguén",
      "Victoria"
    ]
  },
  {
    region: "Región de Los Ríos",
    comunas: [
      "Valdivia",
      "Corral",
      "Lanco",
      "Los Lagos",
      "Máfil",
      "Mariquina",
      "Paillaco",
      "Panguipulli",
      "La Unión",
      "Futrono",
      "Lago Ranco",
      "Río Bueno"
    ]
  },
  {
    region: "Región de Los Lagos",
    comunas: [
      "Puerto Montt",
      "Calbuco",
      "Cochamó",
      "Fresia",
      "Frutillar",
      "Los Muermos",
      "Llanquihue",
      "Maullín",
      "Puerto Varas",
      "Castro",
      "Ancud",
      "Chonchi",
      "Curaco de Vélez",
      "Dalcahue",
      "Puqueldón",
      "Queilén",
      "Quellón",
      "Quemchi",
      "Quinchao",
      "Osorno",
      "Puerto Octay",
      "Purranque",
      "Puyehue",
      "Río Negro",
      "San Juan",
      "San Pablo",
      "Chaitén",
      "Futaleufú",
      "Hualaihué",
      "Palena"
    ]
  },
  {
    region: "Región Aisén del General Carlos Ibáñez del Campo",
    comunas: [
      "Coyhaique",
      "Lago Verde",
      "Aysén",
      "Cisnes",
      "Guaitecas",
      "Cochrane",
      "O’Higins",
      "Tortel",
      "Chile Chico",
      "Río Ibáñez"
    ]
  },
  {
    region: "Región de Magallanes y la Antártica Chilena",
    comunas: [
      "Punta Arenas",
      "Laguna Blanca",
      "Río Verde",
      "San Gregorio",
      "Antártica",
      "Porvenir",
      "Primavera",
      "Timaukel",
      "Puerto Natales",
      "Torres del Paine"
    ]
  },

  {
    region: "Región Arica y Parinacota",
    comunas: ["Arica", "Camarones", "Putre", "Gral. Lagos"]
  },

  {
    region: "Región del Ñuble",
    comunas: [
      "Cobquecura",
      "Coelemu",
      "Ninhue",
      "Portezuelo",
      "Quirihue",
      "Ránquil",
      "Trehuaco",
      "Bulnes",
      "Chillán Viejo",
      "Chillán",
      "El Carmen",
      "Pemuco",
      "Pinto",
      "Quillón",
      "San Ignacio",
      "Yungay",
      "Coihueco",
      "Ñiquén",
      "San Carlos",
      "San Fabián",
      "San Nicolás"
    ]
  }
]};

jQuery(document).ready(function () {
	function chequearRegionComuna(idRegion,idComuna){
		var region = $(idRegion).val();
		var comuna = $(idComuna).val();

		if(region==="sin-region"){
			alert("Seleccione una region");
			return false
		}
		else if(comuna==="sin-comuna"){
			alert("Seleccione una comuna");
			return false
		}
		else{
			return true
		}
	}

	// Verifica que el nombre no sea vacio y que el largo sea menor a 30

	function chequearNombre(idNombre){
		var nombre = $(idNombre).val();
		var regex = /^[a-zA-Z]+(([',. -][a-zA-Z ])?[a-zA-Z]*)*$/
		if(nombre.length<1){
			alert("Ingrese su nombre");
			return false
		}
		else if(!regex.test(nombre)){
			alert("Su nombre no debe contener numeros")
			return false
		}
		else if(nombre.length>30){
			alert("Nombre: Maximo 30 caracteres");
			return false
		}
		else{
			return true
		}
	}

	// Verifica que la experiencia tenga un largo menor a 500

	function chequearExperiencia(idExperiencia){
		var experiencia = $(idExperiencia).val();

		if(experiencia.length>500){
			alert("Experiencia: Maximo 500 caracteres");
			return false
		}
		else{
			return true
		}
	}

	// Valida que las especialidades sean maximo 5 y minimo 1

	function chequearEspecialidades(idEspecialidades){
		var especialidades = $(idEspecialidades);

		if(especialidades.length>5 || especialidades.length<1){
			alert("Especialidades: Maximo 5 especialidades seleccionadas, minimo 1");
			return false
		}
		else{
			return true
		}
	}

	//Valida que las fotos sean min 1 y max 5

	function chequearFotos(idFotos){
		var fotos = $(idFotos);
		var numeroFotos = 0;

		for(i=0;i<fotos.length;i++){
			numeroFotos = numeroFotos + fotos[i].files.length
		}
		if(numeroFotos<1 || numeroFotos>5){
			alert("Debe subir minimo 1 foto y maximo 5")
			return false
		}

		return true
	}


	// Chequea el formato del usuario de Twitter

	function chequearFormatoTwitter(twitter){
		var re = /^@(\w){1,15}$/;

		return re.test(String(twitter))
	}


	//Chequea el formato del email

	function chequearFormatoEmail(email){
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

		return re.test(String(email).toLowerCase());
	}


	//Chequea el formato del numero

	function chequearFormatoNumero(numero){
		var re = /^\+?([0-9]{2})\)?[-. ]?([0-9]{5})[-. ]?([0-9]{4})$/;

		return re.test(String(numero))
	}


	//Campo Opcional
	//Chequea largo minimo 3 y maximo 80, y formato de usuario

	function chequearTwitter(idTwitter){
		var twitter = $(idTwitter).val();

		if(twitter===""){
			return true
		}
		else if(twitter.length<3 || twitter.length>80){
			alert("Usuario de twitter: minimo 3 caracteres, maximo 80")
			return false
		}
		else{
			if(!chequearFormatoTwitter(twitter)){
				alert("Debe ingresar un usuario de twitter valido")
				return false
			}
			return true
		}
	}


	//Campo Obligatorio
	//Chequea formato de email

	function chequearEmail(idEmail){
		var email = $(idEmail).val();

		if(email===''){
			alert("Debe ingresar un email");
			return false
		}

		if(!chequearFormatoEmail(email)){
			alert("Debe ingresar un email valido");
			return false
		}

		return true
	}


	//Campo Opcional
	//Chequea formato de numero movil

	function chequearNumero(idNumero){
		var telefono = $(idNumero).val();

		if(telefono===""){
			return true
		}

		if(!chequearFormatoNumero(telefono)){
			alert("Debe ingresar un numero valido");
			return false
		}

		return true
	}


	function chequearEspecialidadSolicitante(idEspecialidad){
		var especialidades = $(idEspecialidad);

		if(especialidades.length>1){
			alert("Debe seleccionar 1 especialidad");
			return false
		}
		else{
			return true
		}
	}

	function chequearArchivosSolicitante(idArchivos){
		var archivos = $(idArchivos);
		var numeroArchivos = 0;

		for(i=0;i<archivos.length;i++){
			numeroArchivos = numeroArchivos + archivos[i].files.length
		}
		if(numeroArchivos>5){
			alert("Debe subir maximo 5 archivos");
			return false
		}

		return true
	}


	// Agregar nuevos inputs de archivos al agregar medico
	$("#boton-foto-medico").click(function(){
		var numero_inputs = $("#div-foto-medico input[type='file']").length
		if(numero_inputs<5){
			$("#div-foto-medico").append("<input class='form-control-file' type='file' name='foto-medico[]'>");
		}
		else
			alert("Maximo 5 archivos")
	  });

	// Agregar nuevos inputs de archivos al solicitante
	$("#boton-archivos-solicitante").click(function(){
		var numero_inputs = $("#div-archivos-solicitante input[type='file']").length
		if(numero_inputs<5){
			$("#div-archivos-solicitante").append("<input class='form-control-file' name='archivos-solicitante[]' id='archivos-solicitante' type='file'>");
		}
		else
			alert("Maximo 5 archivos")
	});


	// Para que las comunas se filtren por region
	var iRegion = 0;
	var htmlRegion = '<option value="sin-region">Seleccione región</option><option value="sin-region">--</option>';
	var htmlComunas = '<option value="sin-region">Seleccione comuna</option><option value="sin-region">--</option>';

	jQuery.each(RegionesYcomunas.regiones, function () {
		htmlRegion = htmlRegion + '<option value="' + RegionesYcomunas.regiones[iRegion].region + '">' + RegionesYcomunas.regiones[iRegion].region + '</option>';
		iRegion++;
	});

	jQuery('#regiones').html(htmlRegion);
	jQuery('#comunas').html(htmlComunas);

	jQuery('#regiones').change(function () {
		var iRegiones = 0;
		var valorRegion = jQuery(this).val();
		var htmlComuna = '<option value="sin-comuna">Seleccione comuna</option><option value="sin-comuna">--</option>';
		jQuery.each(RegionesYcomunas.regiones, function () {
			if (RegionesYcomunas.regiones[iRegiones].region == valorRegion) {
				var iComunas = 0;
				jQuery.each(RegionesYcomunas.regiones[iRegiones].comunas, function () {
					htmlComuna = htmlComuna + '<option value="' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas] + '">' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas] + '</option>';
					iComunas++;
				});
			}
			iRegiones++;
		});
		jQuery('#comunas').html(htmlComuna);
	});
	jQuery('#comunas').change(function () {
		if (jQuery(this).val() == 'sin-region') {
			alert('seleccione Región');
		} else if (jQuery(this).val() == 'sin-comuna') {
			alert('selecciones Comuna');
		}
	});
	jQuery('#regiones').change(function () {
		if (jQuery(this).val() == 'sin-region') {
			alert('seleccione Región');
		}
	});


    var iRegion = 0;
    var htmlRegion = '<option value="sin-region">Seleccione región</option><option value="sin-region">--</option>';
    var htmlComunas = '<option value="sin-region">Seleccione comuna</option><option value="sin-region">--</option>';

    jQuery.each(RegionesYcomunas.regiones, function () {
        htmlRegion = htmlRegion + '<option value="' + RegionesYcomunas.regiones[iRegion].region + '">' + RegionesYcomunas.regiones[iRegion].region + '</option>';
        iRegion++;
    });

    jQuery('#region-solicitante').html(htmlRegion);
    jQuery('#comuna-solicitante').html(htmlComunas);

    jQuery('#region-solicitante').change(function () {
        var iRegiones = 0;
        var valorRegion = jQuery(this).val();
        var htmlComuna = '<option value="sin-comuna">Seleccione comuna</option><option value="sin-comuna">--</option>';
        jQuery.each(RegionesYcomunas.regiones, function () {
            if (RegionesYcomunas.regiones[iRegiones].region == valorRegion) {
                var iComunas = 0;
                jQuery.each(RegionesYcomunas.regiones[iRegiones].comunas, function () {
                    htmlComuna = htmlComuna + '<option value="' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas] + '">' + RegionesYcomunas.regiones[iRegiones].comunas[iComunas] + '</option>';
                    iComunas++;
                });
            }
            iRegiones++;
        });
        jQuery('#comuna-solicitante').html(htmlComuna);
    });
    jQuery('#comuna-solicitante').change(function () {
        if (jQuery(this).val() == 'sin-region') {
            alert('seleccione Región');
        } else if (jQuery(this).val() == 'sin-comuna') {
            alert('selecciones Comuna');
        }
    });
    jQuery('#region-solicitante').change(function () {
        if (jQuery(this).val() == 'sin-region') {
            alert('seleccione Región');
        }
    });


  
	$("#formulariosolicitud").submit(function(){
		var chequearTwitterEmail = chequearTwitter("#twitter-solicitante") && chequearEmail("#email-solicitante")
		var chequearEspecialidadSintomas = chequearExperiencia("#sintomas-solicitante") && chequearEspecialidadSolicitante("#especialidad-solicitante option:selected")
		var chequearLugarNombre = chequearRegionComuna("#regiones-solicitante","#comunas-solicitante") && chequearNombre("#nombre-solicitante")
		var chequearCelularArchivos = chequearArchivosSolicitante("#div-archivos-solicitante input[type='file']") && chequearNumero("#celular-solicitante")

		return chequearTwitterEmail && chequearEspecialidadSintomas && chequearLugarNombre && chequearCelularArchivos
	});

	$("#formulario").submit(function(){
		return chequearRegionComuna("#regiones","#comunas") && 
		chequearNombre("#nombre-medico") && chequearExperiencia("#experiencia-medico") && 
		chequearEspecialidades("#especialidades-medico option:selected") && chequearFotos("#div-foto-medico input[type='file']") &&
		chequearTwitter("#twitter-medico") && chequearEmail("#email-medico") && chequearNumero("#celular-medico")
	});
  
	jQuery(document).ready(function($) {
		$(".clickable-row").click(function() {
			window.location = $(this).data("href");
		});
	});

});

function mostrarImagen(idDiv, idImg){
	var div = document.getElementById(idDiv);
	div.className = "col py-4 text-center pl-5";
	div.removeChild(div.childNodes[0]);
	var img = document.getElementById(idImg).cloneNode();
	img.width = 800;
	img.height = 600;
	document.getElementById(idDiv).appendChild(img);
}